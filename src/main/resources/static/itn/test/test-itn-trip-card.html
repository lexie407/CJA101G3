<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§ª Itn è¡Œç¨‹å¡ç‰‡å…ƒä»¶æ¸¬è©¦é é¢</title>
    <style>
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .test-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .test-header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .test-header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .test-controls {
            padding: 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }
        
        .test-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .test-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .test-btn.secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            box-shadow: 0 4px 15px rgba(240, 147, 251, 0.3);
        }
        
        .test-btn.secondary:hover {
            box-shadow: 0 6px 20px rgba(240, 147, 251, 0.4);
        }
        
        .test-btn.danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
        }
        
        .test-btn.danger:hover {
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
        }
        
        .test-content {
            padding: 30px;
        }
        
        .test-section {
            margin-bottom: 40px;
        }
        
        .test-section h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .test-status {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .test-status.error {
            background: #ffebee;
            border-color: #f44336;
        }
        
        .test-status.warning {
            background: #fff3e0;
            border-color: #ff9800;
        }
        
        .console-output {
            background: #2d3748;
            color: #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .console-output .success {
            color: #68d391;
        }
        
        .console-output .error {
            color: #fc8181;
        }
        
        .console-output .warning {
            color: #f6ad55;
        }
        
        .console-output .info {
            color: #63b3ed;
        }
        
        #itnTripCardsContainer {
            min-height: 200px;
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            background: #fafafa;
        }
        
        #itnTripCardsContainer:empty::after {
            content: 'ğŸ“‹ é€™è£¡å°‡é¡¯ç¤ºè¡Œç¨‹å¡ç‰‡...';
            color: #999;
            font-style: italic;
            display: block;
            text-align: center;
            padding: 40px;
        }
        
        .test-info {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .test-info h4 {
            margin: 0 0 15px 0;
            color: #1976d2;
        }
        
        .test-info ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .test-info li {
            margin-bottom: 8px;
            color: #424242;
        }
        
        @media (max-width: 768px) {
            .test-buttons {
                flex-direction: column;
            }
            
            .test-btn {
                width: 100%;
            }
            
            .test-header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>ğŸ§ª Itn è¡Œç¨‹å¡ç‰‡å…ƒä»¶æ¸¬è©¦</h1>
            <p>å¿«é€Ÿé©—è­‰å…ƒä»¶åŠŸèƒ½èˆ‡ç›¸å®¹æ€§</p>
        </div>
        
        <div class="test-controls">
            <div class="test-buttons">
                <button class="test-btn" onclick="runQuickTest()">ğŸš€ å¿«é€Ÿæ¸¬è©¦</button>
                <button class="test-btn" onclick="loadBasicData()">ğŸ“‹ è¼‰å…¥åŸºæœ¬è³‡æ–™</button>
                <button class="test-btn" onclick="loadFullData()">ğŸ“‹ è¼‰å…¥å®Œæ•´è³‡æ–™</button>
                <button class="test-btn secondary" onclick="loadCustomTheme()">ğŸ¨ è¼‰å…¥è‡ªè¨‚ä¸»é¡Œ</button>
                <button class="test-btn secondary" onclick="testAPI()">ğŸŒ æ¸¬è©¦ API</button>
                <button class="test-btn danger" onclick="testErrorHandling()">âš ï¸ æ¸¬è©¦éŒ¯èª¤è™•ç†</button>
                <button class="test-btn" onclick="clearContainer()">ğŸ§¹ æ¸…ç©ºå®¹å™¨</button>
            </div>
        </div>
        
        <div class="test-content">
            <div class="test-info">
                <h4>ğŸ“ æ¸¬è©¦èªªæ˜</h4>
                <ul>
                    <li><strong>å¿«é€Ÿæ¸¬è©¦ï¼š</strong>åŸ·è¡Œå®Œæ•´çš„è‡ªå‹•åŒ–æ¸¬è©¦ï¼Œæª¢æŸ¥æ‰€æœ‰åŠŸèƒ½</li>
                    <li><strong>è¼‰å…¥è³‡æ–™ï¼š</strong>æ¸¬è©¦ä¸åŒé¡å‹çš„ç¯„ä¾‹è³‡æ–™è¼‰å…¥</li>
                    <li><strong>è‡ªè¨‚ä¸»é¡Œï¼š</strong>æ¸¬è©¦ä¸»é¡Œè‰²å½©å’ŒæŒ‰éˆ•æ–‡å­—è‡ªè¨‚</li>
                    <li><strong>API æ¸¬è©¦ï¼š</strong>æ¨¡æ“¬å¾ API è¼‰å…¥è³‡æ–™</li>
                    <li><strong>éŒ¯èª¤è™•ç†ï¼š</strong>æ¸¬è©¦ç„¡æ•ˆè³‡æ–™çš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶</li>
                </ul>
            </div>
            
            <div class="test-section">
                <h3>ğŸ“Š æ¸¬è©¦ç‹€æ…‹</h3>
                <div id="testStatus" class="test-status">
                    <strong>æº–å‚™å°±ç·’</strong> - é»æ“Šä¸Šæ–¹æŒ‰éˆ•é–‹å§‹æ¸¬è©¦
                </div>
            </div>
            
            <div class="test-section">
                <h3>ğŸ¯ æ¸¬è©¦çµæœ</h3>
                <div id="consoleOutput" class="console-output">
                    <span class="info">ç­‰å¾…æ¸¬è©¦é–‹å§‹...</span>
                </div>
            </div>
            
            <div class="test-section">
                <h3>ğŸ“± å…ƒä»¶å±•ç¤º</h3>
                <div id="itnTripCardsContainer"></div>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥å…ƒä»¶æª”æ¡ˆ -->
    <script src="../components/itn-trip-card.js"></script>
    <script src="../components/itn-trip-card-data.js"></script>
    
    <script>
        // æ¸¬è©¦ç‹€æ…‹ç®¡ç†
        let testResults = {
            componentLoaded: false,
            dataLoaded: false,
            rendering: false,
            errorHandling: false
        };
        
        // æ›´æ–°æ¸¬è©¦ç‹€æ…‹
        function updateTestStatus(message, type = 'info') {
            const statusEl = document.getElementById('testStatus');
            const statusClass = type === 'error' ? 'error' : type === 'warning' ? 'warning' : '';
            statusEl.className = `test-status ${statusClass}`;
            statusEl.innerHTML = `<strong>${type.toUpperCase()}</strong> - ${message}`;
        }
        
        // æ·»åŠ æ§åˆ¶å°è¼¸å‡º
        function addConsoleOutput(message, type = 'info') {
            const consoleEl = document.getElementById('consoleOutput');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'success' ? 'success' : type === 'error' ? 'error' : type === 'warning' ? 'warning' : 'info';
            consoleEl.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
            consoleEl.scrollTop = consoleEl.scrollHeight;
        }
        
        // å¿«é€Ÿæ¸¬è©¦
        function runQuickTest() {
            updateTestStatus('åŸ·è¡Œå¿«é€Ÿæ¸¬è©¦ä¸­...', 'info');
            addConsoleOutput('ğŸš€ é–‹å§‹åŸ·è¡Œå¿«é€Ÿæ¸¬è©¦...', 'info');
            
            // æª¢æŸ¥å…ƒä»¶è¼‰å…¥
            if (typeof ItnTripCardComponent !== 'undefined') {
                testResults.componentLoaded = true;
                addConsoleOutput('âœ… å…ƒä»¶è¼‰å…¥æˆåŠŸ', 'success');
            } else {
                addConsoleOutput('âŒ å…ƒä»¶è¼‰å…¥å¤±æ•—', 'error');
                updateTestStatus('å…ƒä»¶è¼‰å…¥å¤±æ•—', 'error');
                return;
            }
            
            // æª¢æŸ¥ä¾¿åˆ©å‡½æ•¸
            if (typeof createItnTripCards !== 'undefined') {
                addConsoleOutput('âœ… ä¾¿åˆ©å‡½æ•¸è¼‰å…¥æˆåŠŸ', 'success');
            } else {
                addConsoleOutput('âŒ ä¾¿åˆ©å‡½æ•¸è¼‰å…¥å¤±æ•—', 'error');
            }
            
            // æ¸¬è©¦è³‡æ–™è¼‰å…¥
            try {
                const data = getItnTripSampleData('BASIC');
                testResults.dataLoaded = true;
                addConsoleOutput(`âœ… è³‡æ–™è¼‰å…¥æˆåŠŸ (${data.length} ç­†)`, 'success');
            } catch (error) {
                addConsoleOutput(`âŒ è³‡æ–™è¼‰å…¥å¤±æ•—: ${error.message}`, 'error');
            }
            
            // æ¸¬è©¦æ¸²æŸ“
            try {
                createItnTripCards('#itnTripCardsContainer', getItnTripSampleData('BASIC'), {
                    onRegisterClick: function(trip) {
                        addConsoleOutput(`ğŸ¯ å ±åæŒ‰éˆ•é»æ“Š: ${trip.title}`, 'info');
                    },
                    onDetailClick: function(trip) {
                        addConsoleOutput(`ğŸ” è©³æƒ…æŒ‰éˆ•é»æ“Š: ${trip.title}`, 'info');
                    },
                    onCardClick: function(trip) {
                        addConsoleOutput(`ğŸ“± å¡ç‰‡é»æ“Š: ${trip.title}`, 'info');
                    }
                });
                testResults.rendering = true;
                addConsoleOutput('âœ… å¡ç‰‡æ¸²æŸ“æˆåŠŸ', 'success');
            } catch (error) {
                addConsoleOutput(`âŒ å¡ç‰‡æ¸²æŸ“å¤±æ•—: ${error.message}`, 'error');
            }
            
            // æ¸¬è©¦éŒ¯èª¤è™•ç†
            try {
                const invalidData = [{ title: 'ç„¡æ•ˆè³‡æ–™' }];
                const validation = validateItnTripData(invalidData);
                if (!validation.valid) {
                    testResults.errorHandling = true;
                    addConsoleOutput('âœ… éŒ¯èª¤è™•ç†æ©Ÿåˆ¶æ­£å¸¸', 'success');
                }
            } catch (error) {
                addConsoleOutput(`âŒ éŒ¯èª¤è™•ç†æ¸¬è©¦å¤±æ•—: ${error.message}`, 'error');
            }
            
            // æ¸¬è©¦çµæœç¸½çµ
            const passedTests = Object.values(testResults).filter(Boolean).length;
            const totalTests = Object.keys(testResults).length;
            const successRate = Math.round((passedTests / totalTests) * 100);
            
            addConsoleOutput(`ğŸ¯ æ¸¬è©¦å®Œæˆ: ${passedTests}/${totalTests} é …é€šé (${successRate}%)`, 'info');
            
            if (successRate === 100) {
                updateTestStatus('æ‰€æœ‰æ¸¬è©¦é€šéï¼å…ƒä»¶å¯ä»¥å®‰å…¨ä½¿ç”¨', 'success');
            } else {
                updateTestStatus(`éƒ¨åˆ†æ¸¬è©¦å¤±æ•— (${successRate}% é€šé)`, 'warning');
            }
        }
        
        // è¼‰å…¥åŸºæœ¬è³‡æ–™
        function loadBasicData() {
            updateTestStatus('è¼‰å…¥åŸºæœ¬è³‡æ–™...', 'info');
            addConsoleOutput('ğŸ“‹ è¼‰å…¥åŸºæœ¬ç¯„ä¾‹è³‡æ–™...', 'info');
            
            try {
                const data = getItnTripSampleData('BASIC');
                createItnTripCards('#itnTripCardsContainer', data, {
                    onRegisterClick: function(trip) {
                        addConsoleOutput(`ğŸ¯ å ±å: ${trip.title}`, 'info');
                    },
                    onDetailClick: function(trip) {
                        addConsoleOutput(`ğŸ” è©³æƒ…: ${trip.title}`, 'info');
                    }
                });
                addConsoleOutput(`âœ… åŸºæœ¬è³‡æ–™è¼‰å…¥æˆåŠŸ (${data.length} ç­†)`, 'success');
                updateTestStatus('åŸºæœ¬è³‡æ–™è¼‰å…¥æˆåŠŸ', 'success');
            } catch (error) {
                addConsoleOutput(`âŒ åŸºæœ¬è³‡æ–™è¼‰å…¥å¤±æ•—: ${error.message}`, 'error');
                updateTestStatus('åŸºæœ¬è³‡æ–™è¼‰å…¥å¤±æ•—', 'error');
            }
        }
        
        // è¼‰å…¥å®Œæ•´è³‡æ–™
        function loadFullData() {
            updateTestStatus('è¼‰å…¥å®Œæ•´è³‡æ–™...', 'info');
            addConsoleOutput('ğŸ“‹ è¼‰å…¥å®Œæ•´ç¯„ä¾‹è³‡æ–™...', 'info');
            
            try {
                const data = getItnTripSampleData('FULL');
                createItnTripCards('#itnTripCardsContainer', data, {
                    onRegisterClick: function(trip) {
                        addConsoleOutput(`ğŸ¯ å ±å: ${trip.title}`, 'info');
                    },
                    onDetailClick: function(trip) {
                        addConsoleOutput(`ğŸ” è©³æƒ…: ${trip.title}`, 'info');
                    }
                });
                addConsoleOutput(`âœ… å®Œæ•´è³‡æ–™è¼‰å…¥æˆåŠŸ (${data.length} ç­†)`, 'success');
                updateTestStatus('å®Œæ•´è³‡æ–™è¼‰å…¥æˆåŠŸ', 'success');
            } catch (error) {
                addConsoleOutput(`âŒ å®Œæ•´è³‡æ–™è¼‰å…¥å¤±æ•—: ${error.message}`, 'error');
                updateTestStatus('å®Œæ•´è³‡æ–™è¼‰å…¥å¤±æ•—', 'error');
            }
        }
        
        // è¼‰å…¥è‡ªè¨‚ä¸»é¡Œ
        function loadCustomTheme() {
            updateTestStatus('è¼‰å…¥è‡ªè¨‚ä¸»é¡Œ...', 'info');
            addConsoleOutput('ğŸ¨ è¼‰å…¥è‡ªè¨‚ä¸»é¡Œè³‡æ–™...', 'info');
            
            try {
                const data = getItnTripSampleData('BASIC').map(trip => ({
                    ...trip,
                    theme: {
                        gradient: "linear-gradient(135deg, #ff6b35 0%, #f7931e 100%)",
                        primaryColor: "#ff6b35"
                    },
                    buttons: {
                        register: "æˆ‘è¦åƒåŠ ",
                        detail: "äº†è§£æ›´å¤š"
                    }
                }));
                
                createItnTripCards('#itnTripCardsContainer', data, {
                    onRegisterClick: function(trip) {
                        addConsoleOutput(`ğŸ¯ è‡ªè¨‚å ±å: ${trip.title}`, 'info');
                    },
                    onDetailClick: function(trip) {
                        addConsoleOutput(`ğŸ” è‡ªè¨‚è©³æƒ…: ${trip.title}`, 'info');
                    }
                });
                addConsoleOutput('âœ… è‡ªè¨‚ä¸»é¡Œè¼‰å…¥æˆåŠŸ', 'success');
                updateTestStatus('è‡ªè¨‚ä¸»é¡Œè¼‰å…¥æˆåŠŸ', 'success');
            } catch (error) {
                addConsoleOutput(`âŒ è‡ªè¨‚ä¸»é¡Œè¼‰å…¥å¤±æ•—: ${error.message}`, 'error');
                updateTestStatus('è‡ªè¨‚ä¸»é¡Œè¼‰å…¥å¤±æ•—', 'error');
            }
        }
        
        // æ¸¬è©¦ API
        function testAPI() {
            updateTestStatus('æ¸¬è©¦ API è¼‰å…¥...', 'info');
            addConsoleOutput('ğŸŒ æ¸¬è©¦ API è¼‰å…¥åŠŸèƒ½...', 'info');
            
            try {
                // æ¨¡æ“¬ API è¼‰å…¥
                loadItnTripCardsFromAPI('#itnTripCardsContainer', '/api/test/trips', {
                    onRegisterClick: function(trip) {
                        addConsoleOutput(`ğŸ¯ API å ±å: ${trip.title}`, 'info');
                    },
                    onDetailClick: function(trip) {
                        addConsoleOutput(`ğŸ” API è©³æƒ…: ${trip.title}`, 'info');
                    }
                });
                addConsoleOutput('âœ… API æ¸¬è©¦å•Ÿå‹•æˆåŠŸ', 'success');
                updateTestStatus('API æ¸¬è©¦å•Ÿå‹•æˆåŠŸ', 'success');
            } catch (error) {
                addConsoleOutput(`âŒ API æ¸¬è©¦å¤±æ•—: ${error.message}`, 'error');
                updateTestStatus('API æ¸¬è©¦å¤±æ•—', 'error');
            }
        }
        
        // æ¸¬è©¦éŒ¯èª¤è™•ç†
        function testErrorHandling() {
            updateTestStatus('æ¸¬è©¦éŒ¯èª¤è™•ç†...', 'info');
            addConsoleOutput('âš ï¸ æ¸¬è©¦éŒ¯èª¤è™•ç†æ©Ÿåˆ¶...', 'info');
            
            try {
                const invalidData = [
                    { title: 'ç„¡æ•ˆè³‡æ–™ 1' },
                    { title: 'ç„¡æ•ˆè³‡æ–™ 2', date: '2025-01-01' },
                    { title: 'ç„¡æ•ˆè³‡æ–™ 3', price: 'ä¸æ˜¯æ•¸å­—' }
                ];
                
                const validation = validateItnTripData(invalidData);
                addConsoleOutput(`ğŸ“Š é©—è­‰çµæœ: ${validation.valid ? 'é€šé' : 'å¤±æ•—'}`, validation.valid ? 'success' : 'warning');
                
                if (!validation.valid) {
                    validation.errors.forEach(error => {
                        addConsoleOutput(`âŒ ${error}`, 'info');
                    });
                }
                
                // å˜—è©¦æ¸²æŸ“ç„¡æ•ˆè³‡æ–™
                createItnTripCards('#itnTripCardsContainer', invalidData);
                addConsoleOutput('âœ… éŒ¯èª¤è™•ç†æ©Ÿåˆ¶æ­£å¸¸é‹ä½œ', 'success');
                updateTestStatus('éŒ¯èª¤è™•ç†æ¸¬è©¦å®Œæˆ', 'success');
            } catch (error) {
                addConsoleOutput(`âŒ éŒ¯èª¤è™•ç†æ¸¬è©¦å¤±æ•—: ${error.message}`, 'error');
                updateTestStatus('éŒ¯èª¤è™•ç†æ¸¬è©¦å¤±æ•—', 'error');
            }
        }
        
        // æ¸…ç©ºå®¹å™¨
        function clearContainer() {
            document.getElementById('itnTripCardsContainer').innerHTML = '';
            addConsoleOutput('ğŸ§¹ å®¹å™¨å·²æ¸…ç©º', 'info');
            updateTestStatus('å®¹å™¨å·²æ¸…ç©º', 'info');
        }
        
        // é é¢è¼‰å…¥å®Œæˆå¾Œè‡ªå‹•æª¢æŸ¥
        window.addEventListener('load', function() {
            addConsoleOutput('ğŸ“± æ¸¬è©¦é é¢è¼‰å…¥å®Œæˆ', 'success');
            
            // æª¢æŸ¥å…ƒä»¶æ˜¯å¦è¼‰å…¥
            if (typeof ItnTripCardComponent !== 'undefined') {
                addConsoleOutput('âœ… å…ƒä»¶å·²è¼‰å…¥ï¼Œå¯ä»¥é–‹å§‹æ¸¬è©¦', 'success');
                updateTestStatus('æº–å‚™å°±ç·’ - å…ƒä»¶å·²è¼‰å…¥', 'success');
            } else {
                addConsoleOutput('âŒ å…ƒä»¶è¼‰å…¥å¤±æ•—ï¼Œè«‹æª¢æŸ¥æª”æ¡ˆè·¯å¾‘', 'error');
                updateTestStatus('å…ƒä»¶è¼‰å…¥å¤±æ•—', 'error');
            }
        });
    </script>
</body>
</html> 