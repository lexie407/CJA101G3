<!DOCTYPE html>
<html lang="zh-TW" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>è¡Œç¨‹ç®¡ç† - å¾Œå°ç®¡ç†ç³»çµ±</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- å¼•å…¥å¾Œå°æ¨¡æ¿çš„é ­éƒ¨è³‡æº -->
    <th:block th:replace="~{navBackTemplate :: headResources}"></th:block>
    
    <!-- è¡Œç¨‹æ¨¡çµ„å°ˆç”¨æ¨£å¼ -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/itinerary/back-end/itinerary-common.css}">
    <link rel="stylesheet" th:href="@{/css/itinerary/back-end/itinerary-form.css}">
    <link rel="stylesheet" th:href="@{/css/itinerary/back-end/itinerary-list.css}">
    <script th:src="@{/js/itinerary/back-end/list.js?v=1}" defer></script>
    
    <!-- ğŸ”§ éåº¦éšæ®µï¼šè¨»è§£æ‰CSRF token -->
    <!-- <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/> -->
</head>
<body class="light">
    <div class="app-container">
        <!-- å¼•å…¥å¾Œå°å·¦å´å°èˆª -->
        <th:block th:replace="~{navBackTemplate :: navbar}"></th:block>
        
        <div class="main-content">
            <!-- é ‚éƒ¨å°èˆª -->
            <div th:replace="~{subnavItinerary :: subnav('list')}"></div>

            <main class="content-area-main itinerary-review-page">
        <!-- è‹±é›„å€å¡Šå…¨å¯¬ -->
        <div class="page-header-section">
            <div class="header-content">
                <div class="header-text">
                    <h1>è¡Œç¨‹ç®¡ç†</h1>
                    <p>ç®¡ç†ç³»çµ±ä¸­çš„æ‰€æœ‰è¡Œç¨‹è³‡æ–™</p>
                </div>
                <div class="header-image">
                    <img src="/images/logo.png" alt="è¡Œç¨‹ç®¡ç†ç³»çµ±" class="header-logo">
                </div>
            </div>
        </div>
        <div class="itinerary-list-page">

        <!-- ç¯©é¸æ§åˆ¶å€ -->
        <div class="filter-section">
            <div class="filter-controls">
                <div class="search-box">
                    <input type="text" placeholder="æœå°‹è¡Œç¨‹åç¨±..." id="searchInput" th:value="${param.keyword}">
                    <span class="search-icon">ğŸ”</span>
                </div>

                <!-- ç¯©é¸æŒ‰éˆ•ç¾¤çµ„ -->
                <div class="filter-dropdown-group">
                    <!-- ç‹€æ…‹ç¯©é¸ -->
                    <div class="filter-dropdown" data-filter="status">
                        <button class="filter-btn" id="statusBtn">
                            <span>ç‹€æ…‹ç¯©é¸</span>
                            <span class="filter-arrow">â–¼</span>
                        </button>
                        <div class="dropdown-menu" id="statusDropdown">
                            <div class="dropdown-content">
                                <div class="option-item">
                                    <input type="radio" name="status" value="all" id="status-all" checked>
                                    <label for="status-all">å…¨éƒ¨ç‹€æ…‹</label>
                                </div>
                                <div class="option-item">
                                    <input type="radio" name="status" value="1" id="status-public">
                                    <label for="status-public">å…¬é–‹</label>
                                </div>
                                <div class="option-item">
                                    <input type="radio" name="status" value="0" id="status-private">
                                    <label for="status-private">ç§äºº</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- æ¸…é™¤æŒ‰éˆ• -->
                    <button type="button" class="clear-btn">æ¸…é™¤</button>
                </div>
                
                <!-- å³å´æ§åˆ¶é … -->
                <div class="right-controls">
                    <!-- åˆ†é æ§åˆ¶ -->
                    <div class="pagination-control">
                        <span>æ¯é é¡¯ç¤º</span>
                        <select id="pageSizeSelect">
                            <option value="3">3 ç­†</option>
                            <option value="5">5 ç­†</option>
                            <option value="10" selected>10 ç­†</option>
                            <option value="20">20 ç­†</option>
                            <option value="30">30 ç­†</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æˆåŠŸ/éŒ¯èª¤è¨Šæ¯ -->
        <div th:if="${successMessage}" class="alert alert-success">
            <i class="material-icons">check_circle</i>
            <span th:text="${successMessage}"></span>
        </div>
        <div th:if="${errorMessage}" class="alert alert-error">
            <i class="material-icons">error</i>
            <span th:utext="${errorMessage}"></span> <!-- ä½¿ç”¨utextä»¥æ”¯æŒHTMLæ›è¡Œ -->
        </div>
        
        <!-- è¡¨æ ¼å€åŸŸ -->
        <div class="table-section">
            <div class="table-header">
                <div class="table-title-group">
                    <button type="button" class="sort-btn active" id="sortBtn" title="æ’åº">
                        <span class="sort-icon">â†•</span>
                        <span class="sort-text">æ’åº</span>
                    </button>
                    <h2 class="table-title">
                        è¡Œç¨‹åˆ—è¡¨ <span class="count-badge" id="countBadge" 
                            th:text="|å…± ${#lists.size(itineraries)} ç­†|">å…± 0 ç­†</span>
                    </h2>
                </div>
                <div class="table-actions">
                    <span class="selected-info hidden" id="selectedInfo">å·²é¸æ“‡ <span id="selectedCount">0</span> å€‹é …ç›®</span>
                    <div class="batch-actions">
                        <button type="button" class="batch-btn hidden" id="batchBtn">
                            æ‰¹é‡æ“ä½œ <span class="batch-btn-small">â–¼</span>
                        </button>
                        <div id="batchMenu" class="batch-menu">
                            <div class="dropdown-item" data-action="activate">
                                <i class="material-icons">visibility</i>
                                <span>æ‰¹é‡å…¬é–‹</span>
                            </div>
                            <div class="dropdown-item" data-action="deactivate">
                                <i class="material-icons">visibility_off</i>
                                <span>æ‰¹é‡ç§äºº</span>
                            </div>
                            <div class="dropdown-item danger" data-action="delete">
                                <i class="material-icons">delete</i>
                                <span>æ‰¹é‡åˆªé™¤</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <form id="batchForm" method="post">
            <table class="sample-table">
                <thead>
                    <tr>
                        <th><input type="checkbox" id="selectAll"></th>
                        <th>ID</th>
                        <th>è¡Œç¨‹è³‡è¨Š</th>
                        <th>æ™¯é»æ•¸</th>
                        <th>ç‹€æ…‹</th>
                        <th>å»ºç«‹æ™‚é–“</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:if="${#lists.isEmpty(itineraries)}">
                        <td colspan="7">
                            <div class="empty-state-container">
                                <div class="icon">ğŸ“­</div>
                                <div class="title">ç›®å‰æ²’æœ‰ç¬¦åˆæ¢ä»¶çš„è¡Œç¨‹è³‡æ–™</div>
                                <div class="subtitle">è«‹èª¿æ•´ç¯©é¸æ¢ä»¶æˆ–æ¸…é™¤ç¯©é¸</div>
                            </div>
                        </td>
                    </tr>
                    <tr th:each="itinerary : ${itineraries}">
                        <td data-label="é¸æ“‡"><input type="checkbox" name="itineraryIds" th:value="${itinerary.itnId}" class="itinerary-checkbox"></td>
                        <td data-label="ID"><span class="itinerary-id" th:text="'#' + ${itinerary.itnId}">#1</span></td>
                        <td data-label="è¡Œç¨‹è³‡è¨Š">
                            <div class="itinerary-info">
                                <div class="itinerary-text-info">
                                    <div class="itinerary-name" th:text="${itinerary.itnName}">è¡Œç¨‹åç¨±</div>
                                    <div class="itinerary-desc" th:text="${#strings.abbreviate(itinerary.itnDesc, 50)}">è¡Œç¨‹æè¿°...</div>
                                </div>
                            </div>
                        </td>
                        <td data-label="æ™¯é»æ•¸"><span class="itinerary-days" th:text="${itinerary.spotCount} + ' å€‹'">3 å€‹</span></td>
                        <td data-label="ç‹€æ…‹">
                            <span th:switch="${itinerary.isPublic}">
                                <span th:case="0" class="status-badge status-private">ç§äºº</span>
                                <span th:case="1" class="status-badge status-public">å…¬é–‹</span>
                                <span th:case="*" class="status-badge">æœªçŸ¥</span>
                            </span>
                        </td>
                        <td data-label="å»ºç«‹æ™‚é–“"><span class="itinerary-date" th:text="${#dates.format(itinerary.itnCreateDat, 'yyyy-MM-dd')}">2024-01-01</span></td>
                        <td data-label="æ“ä½œ">
                            <div class="action-buttons">
                                <a th:href="@{/admin/itinerary/detail/{id}(id=${itinerary.itnId})}" class="action-btn btn-view" title="æŸ¥çœ‹">ğŸ‘ï¸</a>
                                <a th:href="@{/admin/itinerary/edit/{id}(id=${itinerary.itnId})}" class="action-btn btn-edit" title="ç·¨è¼¯">âœï¸</a>
                                <form th:action="@{/admin/itinerary/delete/{id}(id=${itinerary.itnId})}" method="post" class="action-form" th:data-itinerary-name="${itinerary.itnName}">
                                    <button type="submit" class="action-btn btn-delete" title="åˆªé™¤">ğŸ—‘ï¸</button>
                                </form>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </form>
        
        <!-- å‰ç«¯åˆ†é æ§åˆ¶ -->
        <div class="pagination-container" id="paginationContainer">
            <nav aria-label="Page navigation">
                <ul class="pagination justify-content-center">
                    <li class="page-item" id="firstPageBtn">
                        <button type="button" class="page-link">
                            <span class="material-icons">first_page</span>
                        </button>
                    </li>
                    <li class="page-item" id="prevPageBtn">
                        <button type="button" class="page-link">
                            <span class="material-icons">chevron_left</span>
                        </button>
                    </li>
                    <!-- é ç¢¼å®¹å™¨ -->
                    <span id="pageNumbers"></span>
                    <li class="page-item" id="nextPageBtn">
                        <button type="button" class="page-link">
                            <span class="material-icons">chevron_right</span>
                        </button>
                    </li>
                    <li class="page-item" id="lastPageBtn">
                        <button type="button" class="page-link">
                            <span class="material-icons">last_page</span>
                        </button>
                    </li>
                </ul>
            </nav>
        </div>
        
        <!-- å‚³éè³‡æ–™åˆ°å‰ç«¯ -->
        <script th:inline="javascript">
            // å¾å¾Œç«¯å‚³éè³‡æ–™åˆ°å‰ç«¯
            window.allItinerariesData = /*[[${simplifiedItineraries}]]*/ [];
            window.currentPage = /*[[${currentPage}]]*/ 0;
            window.pageSize = /*[[${size}]]*/ 10;
            
            console.log('é é¢è³‡æ–™:', {
                allItinerariesData: window.allItinerariesData,
                currentPage: window.currentPage,
                pageSize: window.pageSize,
                totalElements: window.allItinerariesData.length
            });
        </script>
        </div>
            
            </main>
        </div>
    </div>
</body>
</html> 